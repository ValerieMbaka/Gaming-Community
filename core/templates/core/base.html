{% load static %}

<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
	      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

	<title> {% block title %} GameHub | Connect Gamers Across All Platforms {% endblock %} </title>

	<!-- Favicon -->
	<link rel="icon" type="image/x-icon" href="{% static 'core/images/gamepad.jpeg' %}">
	<link rel="icon" type="image/png" sizes="32x32" href="{% static 'core/images/gamepad.jpeg' %}">
	<link rel="icon" type="image/png" sizes="16x16" href="{% static 'core/images/gamepad.jpeg' %}">
	<link rel="apple-touch-icon" sizes="180x180" href="{% static 'core/images/gamepad.jpeg' %}">

	<!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'core/css/base_styles.css' %}">
    <!-- Toast CSS -->
    <link rel="stylesheet" href="{% static 'core/css/toast.css' %}">

	{% block extra_css %} {% endblock %}
	{% block extra_head %} {% endblock %}

</head>
<body>
    <!-- Toast Container -->
    <div id="toast-container"></div>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">
        <div class="container-fluid px-4">
            <!-- Logo + Name -->
            <a class="navbar-brand me-0" href="{% url 'core:home' %}">
                <img src="{% static 'core/images/gamepad.jpeg' %}" alt="GameHub Logo" width="30" height="30" class="d-inline-block align-top me-2" loading="lazy">
                <span class="brand-text">GameHub</span>
            </a>

            <!-- Mobile Toggle -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navigation Links -->
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav me-0">
                    <li class="nav-item me-2"><a class="nav-link active" href="#"><i class="fas fa-home me-1"></i> Home</a></li>
                    <li class="nav-item me-2"><a class="nav-link" href="#about"><i class="fas fa-info-circle me-1"></i> About</a></li>
                    <li class="nav-item me-2"><a class="nav-link" href="#games"><i class="fas fa-gamepad me-1"></i> Games</a></li>
                    <li class="nav-item me-2"><a class="nav-link" href="#platforms"><i class="fas fa-layer-group me-1"></i> Platforms</a></li>
                    <li class="nav-item me-3"><a class="nav-link" href="#blog"><i class="fas fa-newspaper me-1"></i> Blog</a></li>
                    
                    <!-- Authentication Links -->
                    {% if user.is_authenticated or request.session.firebase_authenticated %}
                        <!-- User is logged in - show dashboard -->
                        <li class="nav-item me-2">
                            <a class="nav-link" href="{% url 'users:gamer_dashboard' %}">
                                <i class="fas fa-tachometer-alt me-1"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item me-0">
                            <a class="nav-link" href="{% url 'users:logout' %}">
                                <i class="fas fa-sign-out-alt me-1"></i> Logout
                            </a>
                        </li>
                    {% else %}
                        <!-- User is not logged in - show Join Us/Login -->
                        <li class="nav-item me-2">
                            <a class="nav-link" href="{% url 'users:register' %}">
                                <i class="fas fa-user-plus me-1"></i> Join Us
                            </a>
                        </li>
                        <li class="nav-item me-0">
                            <a class="nav-link" href="{% url 'users:login' %}">
                                <i class="fas fa-sign-in-alt me-1"></i> Login
                            </a>
                        </li>
                    {% endif %}
                    
                    <!-- Theme Toggle -->
                    <li class="nav-item ms-2">
                        <button class="btn btn-outline-primary btn-sm" id="themeToggle" title="Toggle theme">
                            <i class="fas fa-sun" id="lightIcon"></i>
                            <i class="fas fa-moon" id="darkIcon" style="display: none;"></i>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

	<!-- Main Content -->
	<div>
		{% block body %}

		{% endblock %}
	</div>

    <!-- Footer -->
    <footer class="py-5 bg-secondary text-dark">
        <div class="container-fluid px-4">
            <div class="row g-4">
                <div class="col-lg-3">
                    <div class="d-flex align-items-center mb-2">
                        <img src="{% static 'core/images/gamepad.jpeg' %}" alt="GameHub Logo" width="25" height="25" class="me-2" loading="lazy">
                        <span class="fs-6 fw-bold brand-text">GameHub</span>
                    </div>
                    <p class="mb-2">Connecting gamers across all platforms since 2025.</p>
                </div>

                <div class="col-6 col-md-3 col-lg-3">
                    <h6 class="mb-2 fs-6">Quick Links</h6>
                    <ul class="list-unstyled">
                        <li class="mb-1"><a href="#" class="text-muted">Home</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">About</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">Communities</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">Competitions</a></li>
                    </ul>
                </div>

                <div class="col-6 col-md-3 col-lg-3">
                    <h6 class="mb-2 fs-6">Support</h6>
                    <ul class="list-unstyled">
                        <li class="mb-1"><a href="#" class="text-muted">Help Center</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">Contact Us</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">FAQs</a></li>
                    </ul>
                </div>

                <div class="col-md-6 col-lg-3">
                    <h6 class="mb-2 fs-6">Legal</h6>
                    <ul class="list-unstyled">
                        <li class="mb-1"><a href="#" class="text-muted">Privacy Policy</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">Terms of Service</a></li>
                        <li class="mb-1"><a href="#" class="text-muted">Cookie Policy</a></li>
                    </ul>
                </div>
            </div>

            <hr class="my-2 bg-secondary">

            <div class="row">
                <div class="col-12 text-center">
                    <p class="mt-2 small">&copy; 2025 GameHub. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <a href="#" class="btn btn-primary btn-lg back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </a>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{% static 'core/js/base_script.js' %}"></script>
    <!-- Toast JS -->
    <script src="{% static 'core/js/toast.js' %}"></script>
    <!-- Django Messages Data -->
    <script type="application/json" id="django-messages">
        {% if messages %}
            [
                {% for message in messages %}
                    {
                        "text": "{{ message|escapejs }}",
                        "tags": "{{ message.tags }}"
                    }{% if not forloop.last %},{% endif %}
                {% endfor %}
            ]
        {% else %}
            []
        {% endif %}
    </script>
    
    <!-- User Authentication Status -->
    <script type="application/json" id="user-auth-status">
        {% if user.is_authenticated %}
            {"authenticated": true}
        {% else %}
            {"authenticated": false}
        {% endif %}
    </script>
    
    <!-- Django Messages to Toast -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Parse Django messages
                var messagesElement = document.getElementById('django-messages');
                var authElement = document.getElementById('user-auth-status');
                
                if (messagesElement && authElement) {
                    var djangoMessages = JSON.parse(messagesElement.textContent);
                    var authStatus = JSON.parse(authElement.textContent);
                    
                    // Handle Django messages
                    if (djangoMessages && djangoMessages.length > 0) {
                        djangoMessages.forEach(function(message) {
                            if (message && message.text) {
                                showToast(message.text, message.tags || 'info');
                            }
                        });
                    }
                    
                    // Clear profile completion data if user is not authenticated
                    if (!authStatus.authenticated) {
                        localStorage.removeItem('profileCompleted');
                        localStorage.removeItem('updatedProfile');
                    }
                }
            } catch (error) {
                console.error('Error processing Django messages:', error);
            }
        });
    </script>

    <!-- Firebase SDK -->
    <script>
        // Pass Firebase config from Django context
        window.firebaseConfig = {
            apiKey: "{{ firebase_config.api_key|default:'' }}",
            authDomain: "{{ firebase_config.auth_domain|default:'' }}",
            projectId: "{{ firebase_config.project_id|default:'' }}",
            storageBucket: "{{ firebase_config.storage_bucket|default:'' }}",
            messagingSenderId: "{{ firebase_config.messaging_sender_id|default:'' }}",
            appId: "{{ firebase_config.app_id|default:'' }}",
            measurementId: "{{ firebase_config.measurement_id|default:'' }}"
        };
    </script>

	{% block extra_scripts %} {% endblock %}


</body>
</html>