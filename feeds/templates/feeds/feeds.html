{% extends 'core/base_minimal.html' %}
{% load static %}

{% block title %} Gaming Feeds - Stay Updated with Your Community {% endblock %}

{% block dashboard_css %}
    <link rel="stylesheet" href="{% static 'feeds/css/feeds.css' %}">
{% endblock %}

{% block content %}
	<!-- Feeds Header -->
	<section class="feeds-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="feeds-title">Gaming Feeds</h1>
                    <p class="feeds-subtitle">Stay connected with your gaming community</p>
                </div>
            </div>
        </div>
	</section>

	<!-- Filters Bar -->
	<section class="feeds-filters-bar">
        <div class="container">
            <div class="filters-bar d-flex flex-wrap align-items-center gap-2">
                <button class="filter-chip active" data-filter="all"><i class="fas fa-globe me-1"></i> All</button>
                <button class="filter-chip" data-filter="highlights"><i class="fas fa-star me-1"></i> Highlights</button>
                <button class="filter-chip" data-filter="tournaments"><i class="fas fa-trophy me-1"></i> Tournaments</button>
	            <button id="viewMembersBtn" class="btn btn-outline-primary btn-sm ms-auto"><i class="fas fa-users me-1"></i> View Members</button>
            </div>
        </div>
	</section>

	<!-- Feeds Content -->
	<section class="feeds-content">
        <div class="container">
            <div class="row">
                <!-- Main Feed - Left Side -->
                <div class="col-lg-7">
                    <div class="feeds-main">
                        <!-- Create Post -->
                        <div class="post-card start-post-card" id="startPostCard">
                            <div class="start-post-header d-flex align-items-center gap-2">
                                <div class="user-avatar">
                                    <img src="{% static 'core/images/player.jpeg' %}" alt="User Avatar">
                                </div>
                                <button type="button" class="start-post-input w-100 text-start" data-bs-toggle="modal" data-bs-target="#createPostModal">Start a post</button>
                            </div>
                            <div class="start-post-actions d-flex gap-2 mt-2">
                                <button type="button" class="action-btn" data-bs-toggle="modal" data-bs-target="#createPostModal"><i class="fas fa-image"></i> Photo</button>
                                <button type="button" class="action-btn" data-bs-toggle="modal" data-bs-target="#createPostModal"><i class="fas fa-video"></i> Video</button>
                                <button type="button" class="action-btn" data-bs-toggle="modal" data-bs-target="#createPostModal"><i class="fas fa-pen"></i> Write</button>
                            </div>
                        </div>

                        <!-- Feed Posts -->
                        <div class="feed-posts" id="feedPosts">
                            <!-- Post 1 - Tournament Highlight -->
                            <div class="post-card" data-category="tournaments">
                                <div class="post-header">
                                    <div class="user-info">
                                        <div class="user-avatar">
                                            <img src="{% static 'core/images/player1.jpeg' %}" alt="User Avatar">
                                        </div>
                                        <div class="user-details">
                                            <h5 class="username">ProGamer_Elite</h5>
                                            <span class="post-time">2 hours ago</span>
                                        </div>
                                    </div>
                                    <div class="post-menu">
                                        <button class="menu-btn">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="post-content">
                                    <p class="post-text">Just qualified for the Valorant Championship Finals! üéØüî• The competition was intense, but our team pulled through. Can't wait to represent our community in the finals next week! #ValorantChampionship #GamingCommunity</p>
                                    <div class="post-image">
                                        <img src="{% static 'core/images/cod.jpeg' %}" alt="Tournament Victory">
                                    </div>
                                </div>

                                <div class="post-meta-row">
                                    <div class="post-stats">
                                        <div class="stat-item">
                                            <i class="fas fa-heart"></i>
                                            <span>247</span>
                                        </div>
                                        <div class="stat-item comments-stat" data-post-id="1">
                                            <i class="fas fa-comment"></i>
                                            <span>23</span>
                                        </div>
                                        <div class="stat-item">
                                            <i class="fas fa-share"></i>
                                            <span>12</span>
                                        </div>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn like-btn" data-post-id="1">
                                            <i class="fas fa-heart"></i> Like
                                        </button>
                                        <button class="action-btn comment-btn" data-post-id="1">
                                            <i class="fas fa-comment"></i> Comment
                                        </button>
                                        <button class="action-btn share-btn" data-post-id="1">
                                            <i class="fas fa-share"></i> Share
                                        </button>
                                    </div>
                                </div>

                                <!-- Comments Section -->
                                <div class="comments-section" id="comments-1">
                                    <div class="comment-input d-none">
                                        <img src="{% static 'core/images/player.jpeg' %}" alt="User Avatar" class="comment-avatar">
                                        <input type="text" placeholder="Write a comment..." class="comment-text">
                                        <button class="comment-send">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    <div class="comments-list d-none">
                                        <div class="comment">
                                            <img src="{% static 'core/images/player2.jpeg' %}" alt="User Avatar" class="comment-avatar">
                                            <div class="comment-content">
                                                <div class="comment-header">
                                                    <span class="comment-username">GamingLegend</span>
                                                    <span class="comment-time">1 hour ago</span>
                                                </div>
                                                <p class="comment-text">Amazing performance! Good luck in the finals! üèÜ</p>
                                            </div>
                                        </div>
                                        <div class="comment">
                                            <img src="{% static 'core/images/player3.jpeg' %}" alt="User Avatar" class="comment-avatar">
                                            <div class="comment-content">
                                                <div class="comment-header">
                                                    <span class="comment-username">ValorantPro</span>
                                                    <span class="comment-time">30 minutes ago</span>
                                                </div>
                                                <p class="comment-text">Your team coordination was perfect! üî•</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Post 2 - Gaming Setup -->
                            <div class="post-card" data-category="highlights">
                                <div class="post-header">
                                    <div class="user-info">
                                        <div class="user-avatar">
                                            <img src="{% static 'core/images/player2.jpeg' %}" alt="User Avatar">
                                        </div>
                                        <div class="user-details">
                                            <h5 class="username">SetupMaster</h5>
                                            <span class="post-time">5 hours ago</span>
                                        </div>
                                    </div>
                                    <div class="post-menu">
                                        <button class="menu-btn">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="post-content">
                                    <p class="post-text">Finally completed my dream gaming setup! üéÆ‚ú® RGB everything, ultrawide monitor, and the perfect chair. Ready to dominate in any game! #GamingSetup #RGBLife #GamingCommunity</p>
                                    <div class="post-image">
                                        <img src="{% static 'core/images/gameroom.jpeg' %}" alt="Gaming Setup">
                                    </div>
                                </div>

                                <div class="post-meta-row">
                                    <div class="post-stats">
                                        <div class="stat-item">
                                            <i class="fas fa-heart"></i>
                                            <span>892</span>
                                        </div>
                                        <div class="stat-item comments-stat" data-post-id="2">
                                            <i class="fas fa-comment"></i>
                                            <span>67</span>
                                        </div>
                                        <div class="stat-item">
                                            <i class="fas fa-share"></i>
                                            <span>34</span>
                                        </div>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn like-btn" data-post-id="2">
                                            <i class="fas fa-heart"></i> Like
                                        </button>
                                        <button class="action-btn comment-btn" data-post-id="2">
                                            <i class="fas fa-comment"></i> Comment
                                        </button>
                                        <button class="action-btn share-btn" data-post-id="2">
                                            <i class="fas fa-share"></i> Share
                                        </button>
                                    </div>
                                </div>
                                <!-- Comments Section -->
                                <div class="comments-section" id="comments-2">
                                    <div class="comment-input d-none">
                                        <img src="{% static 'core/images/player.jpeg' %}" alt="User Avatar" class="comment-avatar">
                                        <input type="text" placeholder="Write a comment..." class="comment-text">
                                        <button class="comment-send">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    <div class="comments-list d-none">
                                        <div class="comment">
                                            <img src="{% static 'core/images/player1.jpeg' %}" alt="User Avatar" class="comment-avatar">
                                            <div class="comment-content">
                                                <div class="comment-header">
                                                    <span class="comment-username">RGBEnthusiast</span>
                                                    <span class="comment-time">3 hours ago</span>
                                                </div>
                                                <p class="comment-text">That setup is clean! What chair model is that?</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Post 3 - Tips & Tricks -->
                            <div class="post-card" data-category="tips">
                                <div class="post-header">
                                    <div class="user-info">
                                        <div class="user-avatar">
                                            <img src="{% static 'core/images/player3.jpeg' %}" alt="User Avatar">
                                        </div>
                                        <div class="user-details">
                                            <h5 class="username">FIFA_Pro_Tips</h5>
                                            <span class="post-time">1 day ago</span>
                                        </div>
                                    </div>
                                    <div class="post-menu">
                                        <button class="menu-btn">
                                            <i class="fas fa-ellipsis-h"></i>
                                        </button>
                                    </div>
                                </div>

                                <div class="post-content">
                                    <p class="post-text">üî• FIFA 25 Pro Tip: Master the new skill moves! The "Elastico" and "Roulette" are game-changers this year. Practice in skill games for 10 minutes daily and watch your gameplay improve dramatically! #FIFA25Tips #GamingTips</p>
                                </div>

                                <div class="post-meta-row">
                                    <div class="post-stats">
                                        <div class="stat-item">
                                            <i class="fas fa-heart"></i>
                                            <span>1,234</span>
                                        </div>
                                        <div class="stat-item comments-stat" data-post-id="3">
                                            <i class="fas fa-comment"></i>
                                            <span>89</span>
                                        </div>
                                        <div class="stat-item">
                                            <i class="fas fa-share"></i>
                                            <span>156</span>
                                        </div>
                                    </div>
                                    <div class="post-actions">
                                        <button class="action-btn like-btn" data-post-id="3">
                                            <i class="fas fa-heart"></i> Like
                                        </button>
                                        <button class="action-btn comment-btn" data-post-id="3">
                                            <i class="fas fa-comment"></i> Comment
                                        </button>
                                        <button class="action-btn share-btn" data-post-id="3">
                                            <i class="fas fa-share"></i> Share
                                        </button>
                                    </div>
                                </div>
                        
                                <!-- Comments Section -->
                                <div class="comments-section" id="comments-3">
                                    <div class="comment-input d-none">
                                        <img src="{% static 'core/images/player.jpeg' %}" alt="User Avatar" class="comment-avatar">
                                        <input type="text" placeholder="Write a comment..." class="comment-text">
                                        <button class="comment-send">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Load More Button -->
                    <div class="load-more-section">
                        <button class="btn btn-outline-primary load-more-btn">
                            <i class="fas fa-spinner me-2"></i>Load More Posts
                        </button>
                    </div>
                </div>
            </div>

            <!-- Leaderboard & Events - Right Side -->
            <div class="col-lg-5">
                <div class="feeds-sidebar">
                    <!-- Leaderboard -->
                    <div class="leaderboard-aside">
                        <h4 class="suggestions-title d-flex align-items-center justify-content-between">
                            <span><i class="fas fa-crown me-2 text-warning"></i>Global Leaderboard</span>
                            <small class="text-muted">Top players overall</small>
                        </h4>
                        <div id="globalLeaderboard" class="lb-rows">
                            <!-- Dummy data (static for now) -->
                            <div class="lb-row">
                                <div class="rank">1</div>
                                <img src="{% static 'core/images/player2.jpeg' %}" alt="FIFA_Master" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">FIFA_Master</div>
                                    <div class="meta">FIFA 25</div>
                                </div>
                                <div class="points ms-auto"><i class="fas fa-star text-warning me-1"></i>3120 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">2</div>
                                <img src="{% static 'core/images/player1.jpeg' %}" alt="GoalMachine" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">GoalMachine</div>
                                    <div class="meta">FIFA 25</div>
                                </div>
                                <div class="points ms-auto">3005 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">3</div>
                                <img src="{% static 'core/images/player3.jpeg' %}" alt="COD_Elite" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">COD_Elite</div>
                                    <div class="meta">Call of Duty</div>
                                </div>
                                <div class="points ms-auto">2950 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">4</div>
                                <img src="{% static 'core/images/player3.jpeg' %}" alt="SkillMovesPro" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">SkillMovesPro</div>
                                    <div class="meta">FIFA 25</div>
                                </div>
                                <div class="points ms-auto">2875 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">5</div>
                                <img src="{% static 'core/images/player1.jpeg' %}" alt="WarzoneAce" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">WarzoneAce</div>
                                    <div class="meta">Call of Duty</div>
                                </div>
                                <div class="points ms-auto">2830 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">6</div>
                                <img src="{% static 'core/images/player2.jpeg' %}" alt="SniperWolf" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">SniperWolf</div>
                                    <div class="meta">Call of Duty</div>
                                </div>
                                <div class="points ms-auto">2795 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">7</div>
                                <img src="{% static 'core/images/player1.jpeg' %}" alt="ValorantQueen" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">ValorantQueen</div>
                                    <div class="meta">Valorant</div>
                                </div>
                                <div class="points ms-auto">2680 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">8</div>
                                <img src="{% static 'core/images/player2.jpeg' %}" alt="AgentSharp" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">AgentSharp</div>
                                    <div class="meta">Valorant</div>
                                </div>
                                <div class="points ms-auto">2540 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">9</div>
                                <img src="{% static 'core/images/player3.jpeg' %}" alt="SpikeMaster" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">SpikeMaster</div>
                                    <div class="meta">Valorant</div>
                                </div>
                                <div class="points ms-auto">2410 pts</div>
                            </div>
                            <div class="lb-row">
                                <div class="rank">10</div>
                                <img src="{% static 'core/images/player.jpeg' %}" alt="You" class="avatar-sm">
                                <div class="user-col">
                                    <div class="name">You</div>
                                    <div class="meta">Valorant</div>
                                </div>
                                <div class="points ms-auto">1200 pts</div>
                            </div>
                        </div>
                    </div>

                    <!-- Upcoming Events -->
                    <div class="upcoming-events">
                        <h4 class="events-title">Upcoming Events</h4>
                        <div class="event-list">
                            <div class="event-item">
                                <div class="event-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="event-info">
                                    <h6 class="event-title">Valorant Championship</h6>
                                    <small class="event-time">Tomorrow, 8:00 PM</small>
                                </div>
                            </div>
                            <div class="event-item">
                                <div class="event-icon">
                                    <i class="fas fa-gamepad"></i>
                                </div>
                                <div class="event-info">
                                    <h6 class="event-title">FIFA 25 Tournament</h6>
                                    <small class="event-time">Saturday, 2:00 PM</small>
                                </div>
                            </div>
                            <div class="event-item">
                                <div class="event-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="event-info">
                                    <h6 class="event-title">Community Meetup</h6>
                                    <small class="event-time">Sunday, 6:00 PM</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Members Panel - toggled by clicking the "View Members" button -->
                    <div id="membersPanel" class="members-panel d-none">
                        <div class="members-header d-flex flex-wrap align-items-center justify-content-between gap-2">
                            <h4 class="mb-0"><i class="fas fa-users me-2"></i>All Members</h4>
                            <div class="d-flex align-items-center gap-2">
                                <div class="members-search">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="membersSearch" placeholder="Search members by name or community..." />
                                </div>
                                <div class="members-filters d-flex flex-wrap gap-2">
                                    <button class="chip chip-sm active" data-community="all">All</button>
                                    <button class="chip chip-sm" data-community="valorant">Valorant</button>
                                    <button class="chip chip-sm" data-community="fifa25">FIFA 25</button>
                                    <button class="chip chip-sm" data-community="cod">Call of Duty</button>
                                </div>
                                <button id="backToFeed" class="btn btn-sm btn-outline-secondary">Back to Feed</button>
                            </div>
                        </div>
                        <div id="membersList" class="members-list mt-3"></div>
                    </div>
                </div>
            </div>
        </div>
	</section>

{% endblock %}

{% block scripts %}
    <script src="{% static 'feeds/js/feeds.js' %}"></script>
    <!-- Create Post Modal -->
    <div class="modal fade" id="createPostModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create a post</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="modalPostForm">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="d-flex align-items-start gap-2 mb-2">
                            <div class="user-avatar">
                                <img src="{% static 'core/images/player.jpeg' %}" alt="User Avatar">
                            </div>
                            <textarea class="form-control" id="modalPostContent" name="content" rows="4" placeholder="What do you want to talk about?"></textarea>
                        </div>
                        <div class="d-flex gap-2">
                            <label class="btn btn-outline-secondary btn-sm mb-0">
                                <i class="fas fa-image me-1"></i> Photo
                                <input type="file" accept="image/*" id="modalPhotoInput" name="image" hidden>
                            </label>
                            <label class="btn btn-outline-secondary btn-sm mb-0">
                                <i class="fas fa-video me-1"></i> Video
                                <input type="file" accept="video/*" id="modalVideoInput" name="video" hidden>
                            </label>
                        </div>
                        <div class="mt-3" id="modalMediaPreview" style="display:none;">
                            <img id="modalImagePreview" src="" alt="Preview" style="max-width:100%; border-radius:8px;">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Post</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}
