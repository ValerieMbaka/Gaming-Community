{% load static %}

<div class="profile-completion-container">
    <div class="profile-completion-card">
        <div class="profile-form">
            <form id="profileForm" method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Profile Picture Section -->
                <div class="form-section">
                    <label>Avatar <small class="text-muted">(optional)</small></label>
                    <small class="form-text">Upload a profile picture (JPG, PNG, GIF up to 5MB)</small>
                    <div class="avatar-upload">
                        <div class="avatar-preview-holder">
                            <img id="avatarPreview" src="{% static 'core/images/player.jpeg' %}" alt="Avatar Preview" class="avatar-preview-image">
                            <div class="avatar-placeholder" id="avatarPlaceholder">
                                <i class="fas fa-user"></i>
                            </div>
                        </div>
                        <input type="file" name="profile_picture" id="id_profile_picture" accept="image/*">
                        <label for="id_profile_picture" class="avatar-upload-label">
                            <i class="fas fa-camera"></i>
                            <span>Choose Avatar</span>
                        </label>
                    </div>
                </div>

            <!-- Username Section -->
            <div class="form-section">
                <label for="id_custom_username">Username <span class="required">*</span></label>
                <small class="form-text">3-20 characters(letters, numbers, and underscores only)</small>
                <div class="username-input-group">
                    <input type="text" name="custom_username" id="id_custom_username" 
                           value="{{ form.custom_username.value|default:'' }}" 
                           placeholder="Enter your username" required>
                    <button type="button" id="generateUsernameBtn" class="generate-btn">
                        <i class="fas fa-dice"></i>
                        Generate Username
                    </button>
                </div>
                <div id="custom_username-error" class="error-message"></div>
            </div>

            <!-- Bio Section -->
            <div class="form-section">
                <label for="id_bio">Bio <span class="required">*</span></label>
                <input type="text" name="bio" id="id_bio" 
                       value="{% if form.bio.value and form.bio.value != 'Bio' %}{{ form.bio.value }}{% endif %}" 
                       placeholder="Tell us about yourself in one line" required>
                <div id="bio-error" class="error-message"></div>
            </div>

            <!-- About Section -->
            <div class="form-section">
                <label for="id_about">About <small class="text-muted">(optional)</small></label>
                <textarea name="about" id="id_about" rows="4" 
                          placeholder="Tell us more about yourself, your gaming experience, and what you're looking for in the community">{% if form.about.value and form.about.value != 'About' %}{{ form.about.value }}{% endif %}</textarea>
                <div class="char-counter">
                    <span id="aboutCounter">0</span>
                </div>
            </div>

            <!-- Date of Birth Section -->
            <div class="form-section">
                <label for="id_date_of_birth">Date of Birth <span class="required">*</span></label>
                <div class="date-picker-container">
                    <div class="date-input-group">
                        <select id="dobDay" name="dob_day" class="date-select">
                            <option value="">Date</option>
                        </select>
                        <select id="dobMonth" name="dob_month" class="date-select">
                            <option value="">Month</option>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                        <select id="dobYear" name="dob_year" class="date-select">
                            <option value="">Year</option>
                        </select>
                    </div>
                    <input type="hidden" name="date_of_birth" id="id_date_of_birth" value="{{ form.date_of_birth.value|date:'Y-m-d'|default:'' }}" required>
                </div>
                <small class="form-text">Please select day, month, and year</small>
                <div id="date_of_birth-error" class="error-message"></div>
            </div>

            <!-- Location Section -->
            <div class="form-section">
                <label for="id_location">Location <span class="required">*</span></label>
                <input type="text" name="location" id="id_location"
                       value="{% if form.location.value and form.location.value != '' %}{{ form.location.value }}{% endif %}" 
                       placeholder="Enter your location (e.g., London, UK)" required>
                <div id="location-error" class="error-message"></div>
            </div>

            <!-- Platforms Section -->
            <div class="form-section">
                <label>Gaming Platforms <span class="required">*</span></label>
                <small class="form-text">Select the platforms you game on</small>
                <div class="chips" id="platformsTags"></div>
                <input type="hidden" name="platforms" id="id_platforms" value="{{ form.platforms.value|default:'[]' }}">
                <div id="platforms-error" class="error-message"></div>
            </div>

            <!-- Games Section -->
            <div class="form-section">
                <label>Favorite Games <span class="required">*</span></label>
                <small class="form-text">Select your favorite games or add custom ones</small>
                <div class="games-container">
                    <div class="games-tags-section">
                        <div class="chips" id="gamesTags"></div>
                    </div>
                    <div class="game-input-section">
                        <input type="text" id="gameInput" placeholder="Add a game..." class="game-input">
                        <small class="form-text">Type and press Enter to add custom games</small>
                    </div>
                </div>
                <input type="hidden" name="games" id="id_games" value="{{ form.games.value|default:'[]' }}">
                <div id="games-error" class="error-message"></div>
            </div>

            <!-- Submit Button -->
            <div class="form-actions">
                <button type="submit" class="save-btn">Save Details</button>
            </div>
        </form>
        </div>
    </div>
</div>